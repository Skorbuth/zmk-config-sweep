/*
*
* Copyright (c) 2022 Rafael Romão
* SPDX-License-Identifier: MIT
*
*/
/*                KEY POSITIONS

  ╭─────────────────────╮ ╭─────────────────────╮
  │ LTP LTR LTM LTI LTC │ │ RTC RTI RTM RTR RTP │
  │ LHP LHR LHM LHI LHC │ │ RHC RHI RHM RHR RHP │
  │ LBP LBR LBM LBI LBC │ │ RBC RBI RBM RB3 RBP │
  ╰───────╮ L2  L1  L0  │ │ R0  R1  R2  ╭───────╯
          ╰─────────────╯ ╰─────────────╯ */

/*                              34 KEY MATRIX / LAYOUT MAPPING

  ╭────────────────────┬────────────────────╮ ╭─────────────────────┬─────────────────────╮
  │  0   1   2   3   4 │  5   6   7   8   9 │ │ LT4 LT3 LT2 LT1 LT0 │ RT0 RT1 RT2 RT3 RT4 │
  │ 10  11  12  13  14 │ 15  16  17  18  19 │ │ LM4 LM3 LM2 LM1 LM0 │ RM0 RM1 RM2 RM3 RM4 │
  │ 20  21  22  23  24 │ 25  26  27  28  29 │ │ LB4 LB3 LB2 LB1 LB0 │ RB0 RB1 RB2 RB3 RB4 │
  ╰───────────╮ 30  31 │ 32  33 ╭───────────╯ ╰───────────╮ LH1 LH0 │ RH0 RH1 ╭───────────╯
              ╰────────┴────────╯                         ╰─────────┴─────────╯             */

          &leader {
            timeout-ms = <500>;
        };
        
        / {
        
            #define LEADER_MACRO(NAME, BINDINGS) \
                NAME: NAME { \
                    compatible = "zmk,behavior-macro"; \
                    #binding-cells = <0>; \
                    wait-ms = <10>; \
                    tap-ms = <10>; \
                    bindings = <&macro_tap BINDINGS>; \
                };
        
            #define LEADER_SEQ(NAME, KEYS, BINDINGS, LAYERS) \
                NAME { \
                    key-positions = <KEYS>; \
                    bindings = <BINDINGS>; \
                    layers = <LAYERS>; \
                };
        
            macros {
                LEADER_MACRO(mc_section, &kp LA(N6))
                LEADER_MACRO(mc_orda,    &kp LA(N0))
                LEADER_MACRO(mc_ordo,    &kp LA(N9))
                LEADER_MACRO(mc_deg,     &kp LS(LA(N8)))
            };
        
            leader_sequences {
                compatible = "zmk,leader-sequences";
        
                LEADER_SEQ(ld_sect, RB3 LM2 , &mc_section, DEF)
                LEADER_SEQ(ld_orda, RB3 RT2 , &mc_orda, DEF)
                LEADER_SEQ(ld_ordo, RB3 RM2 , &mc_ordo, DEF)
                LEADER_SEQ(ld_deg,  RB3 LM1 , &mc_deg, DEF)
            };
        
            dynamic_macros {
                dynmacro: dynmacro {
                    compatible = "zmk,behavior-dynamic-macro";
                    label = "dynmacro";
                    #binding-cells = <1>;
                    wait-ms = <1>;
                };
        
                td_dynmacro: td_dynmacro {
                    compatible = "zmk,behavior-tap-dance";
                    #binding-cells = <0>;
                    tapping-term-ms = <TD_TAPPING_TERM>;
                    bindings = <&dynmacro PLAY>, <&dynmacro RECORD>, <&none>;
                };
            };
        };